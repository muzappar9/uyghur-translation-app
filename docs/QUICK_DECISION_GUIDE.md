# Flutter è·¯ç”±å’Œå­˜å‚¨æ–¹æ¡ˆ - å¿«é€Ÿå†³ç­–æŒ‡å—

## ä¸€é¡µçº¸æ€»ç»“

### è·¯ç”±æ–¹æ¡ˆé€‰æ‹©çŸ©é˜µ

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç†ç”± |
|------|---------|------|
| **ç”Ÿäº§åº”ç”¨** | go_router | âœ… å®˜æ–¹ç»´æŠ¤ã€æœ€ç¨³å®šã€ç¤¾åŒºæœ€å¤§ |
| **ç®€å•åº”ç”¨** | GetX | âœ… API æœ€ç®€å•ã€å­¦ä¹ æ›²çº¿ä½ |
| **å¤§å‹é¡¹ç›®** | AutoRoute | âœ… ç±»å‹å®‰å…¨ã€ä»£ç ç”Ÿæˆã€ç»“æ„æ¸…æ™° |
| **Web é‡ç‚¹** | go_router/Beamer | âœ… Web æ”¯æŒæœ€å®Œæ•´ |
| **å›¢é˜Ÿæ–°æ‰‹** | go_router | âœ… æ–‡æ¡£æœ€è¯¦ç»† |

### æ•°æ®åº“æ–¹æ¡ˆé€‰æ‹©çŸ©é˜µ

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç†ç”± |
|------|---------|------|
| **ç¿»è¯‘åº”ç”¨** | Isar + Hive | âœ… æ€§èƒ½æœ€ä¼˜ã€åŠŸèƒ½å…¨é¢ |
| **ç®€å•é…ç½®å­˜å‚¨** | Hive | âœ… æé€Ÿã€åŠ å¯†ã€æ— é…ç½® |
| **å¤æ‚å…³ç³»æ•°æ®** | sqflite | âœ… æœ€æˆç†Ÿã€SQL å®Œæ•´ |
| **è·¨å¹³å° Web** | Sembast | âœ… çº¯ Dartã€æ— ä¾èµ– |
| **Android èƒŒæ™¯å›¢é˜Ÿ** | Floor | âœ… Room é£æ ¼ã€ç†Ÿæ‚‰ |

---

## ç¿»è¯‘åº”ç”¨æœ€ä¼˜æ¨è (ä½ çš„é¡¹ç›®)

### ğŸ¯ æœ€ç»ˆé€‰æ‹©

```
è·¯ç”±: go_router 17.0 + Riverpod 3.0
æ•°æ®åº“: Isar 3.1 + Hive 2.2
çŠ¶æ€ç®¡ç†: Riverpod (é›†æˆ)
```

### ğŸ“Š æ€§èƒ½æ‰¿è¯º

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… |
|------|------|------|
| åº”ç”¨å¯åŠ¨æ—¶é—´ | < 2s | ~1.5s |
| æŸ¥è¯¢ 1000 æ¡ç¿»è¯‘ | < 100ms | ~20ms |
| å†™å…¥ 1000 æ¡è®°å½• | < 500ms | ~50ms |
| æœç´¢å“åº”æ—¶é—´ | < 300ms | ~100ms |
| å†…å­˜å ç”¨ | < 100MB | ~60MB |

### ğŸ’° å­¦ä¹ æˆæœ¬å¯¹æ¯”

```
go_router:     â­â­â˜†â˜†â˜† (2-3 å¤©å­¦ä¼šæ ¸å¿ƒ)
Riverpod:      â­â­â­â˜†â˜† (3-5 å¤©å­¦ä¼šæ ¸å¿ƒ)
Isar:          â­â­â­â˜†â˜† (2-3 å¤©å­¦ä¼š)
Hive:          â­â˜†â˜†â˜†â˜† (1 å¤©å­¦ä¼š)

æ€»ä½“: 5-7 å¤©èƒ½å®Œæ•´æŒæ¡æ•´ä¸ªå †æ ˆ
```

---

## å…³é”®å†³ç­–ç‚¹è§£æ

### 1ï¸âƒ£ ä¸ºä»€ä¹ˆé€‰ go_router?

```
å¯¹æ¯”ç»´åº¦          go_router    AutoRoute    GetX      Beamer
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å®˜æ–¹æ”¯æŒ          âœ…âœ…âœ…       âŒ           âŒ         âŒ
æ–‡æ¡£è´¨é‡          âœ…âœ…âœ…       âœ…âœ…         âœ…         âœ…
ä»£ç ç”Ÿæˆ          âŒ           âœ…âœ…         âŒ         âŒ
å­¦ä¹ éš¾åº¦          ç®€           ä¸­           æç®€       ä¸­
ç¤¾åŒºè§„æ¨¡          âœ…âœ…âœ…       âœ…âœ…         âœ…âœ…âœ…     âœ…
Web æ”¯æŒ          âœ…âœ…âœ…       âœ…           âŒ         âœ…âœ…
Riverpod é›†æˆ     âœ…âœ…âœ…       âŒ           âŒ         âŒ
ç»´æŠ¤çŠ¶æ€          æ´»è·ƒ         æ´»è·ƒ         æ´»è·ƒ       æ´»è·ƒ
```

**æ ¸å¿ƒåŸå› **:
- âœ… åŠŸèƒ½å®Œæ•´ (99% åœºæ™¯è¦†ç›–)
- âœ… å®˜æ–¹ç»´æŠ¤ (é•¿æœŸæ”¯æŒ)
- âœ… Riverpod å‹å¥½ (å¤©ç„¶é›†æˆ)
- âœ… Web æ”¯æŒ (å®Œæ•´å…¼å®¹)

### 2ï¸âƒ£ ä¸ºä»€ä¹ˆé€‰ Isar + Hive?

```
æ“ä½œç±»å‹        sqflite    Isar    Hive    Floor   Sembast
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ç®€å•æŸ¥è¯¢         â­â­â­â­   â­â­â­â­â­  â­â­â­   â­â­â­â­   â­â­
å¤æ‚æŸ¥è¯¢         â­â­â­â­â­  â­â­â­â­â­  âŒ      â­â­â­â­â­  â­â­
å†™å…¥æ€§èƒ½         â­â­â­   â­â­â­â­â­  â­â­â­â­â­  â­â­â­   â­â­
åŠ å¯†æ”¯æŒ         âŒ      â­â­â­â­   â­â­â­â­â­  âŒ      â­â­â­â­
Web æ”¯æŒ        âš ï¸       âœ…      âœ…      âš ï¸       âœ…
è·¨å¹³å°           âœ…      âœ…      âœ…      âœ…      âœ…âœ…
```

**æ ¸å¿ƒåŸå› **:
- âœ… Isar: æ€§èƒ½æœ€ä¼˜ï¼ŒæŸ¥è¯¢è¯­è¨€å®Œæ•´
- âœ… Hive: é…ç½®å­˜å‚¨æœ€å¿«ï¼ŒåŠ å¯†å†…ç½®
- âœ… ç»„åˆæ–¹æ¡ˆ: å„å¸å…¶èŒï¼Œäº’è¡¥ä¼˜åŠ¿

---

## å®ç°å‚è€ƒæ•°æ®

### ç¿»è¯‘ App æ•°æ®åº“è®¾è®¡ç¤ºä¾‹

```dart
// å­˜å‚¨éœ€æ±‚åˆ†æ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¿»è¯‘åº”ç”¨æ•°æ®æ¨¡å‹                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. TranslationHistory                â”‚
â”‚    - ID, æºæ–‡æœ¬, ç›®æ ‡æ–‡æœ¬             â”‚
â”‚    - è¯­è¨€å¯¹, æ—¶é—´æˆ³, æ”¶è—æ ‡è®°         â”‚
â”‚    - ä½¿ç”¨æ¬¡æ•°, ç½®ä¿¡åº¦ (å¯é€‰)         â”‚
â”‚                                     â”‚
â”‚ 2. FavoritePhrase                    â”‚
â”‚    - ID, æºæ–‡æœ¬, ç›®æ ‡æ–‡æœ¬             â”‚
â”‚    - åˆ†ç±»æ ‡ç­¾, ç”¨æˆ·æ³¨é‡Š               â”‚
â”‚    - åˆ›å»ºæ—¶é—´                        â”‚
â”‚                                     â”‚
â”‚ 3. SearchRecord                      â”‚
â”‚    - ID, æŸ¥è¯¢æ–‡æœ¬, æ—¶é—´æˆ³             â”‚
â”‚    - æŸ¥è¯¢æ¬¡æ•°                        â”‚
â”‚                                     â”‚
â”‚ 4. UserPreferences (Hive)            â”‚
â”‚    - æºç›®æ ‡è¯­è¨€, ä¸»é¢˜, å­—ä½“å¤§å°       â”‚
â”‚    - å£°éŸ³å¼€å…³, æœ€å¤§å†å²è®°å½•æ•°         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¢„æœŸæ•°æ®é‡

```
å°å‹åº”ç”¨ (< 1ä¸‡ç”¨æˆ·)
â”œâ”€â”€ ç¿»è¯‘å†å²: æ¯ç”¨æˆ· 1000-5000 æ¡
â”œâ”€â”€ æ”¶è—è¯æ±‡: æ¯ç”¨æˆ· 100-500 æ¡
â”œâ”€â”€ æœç´¢è®°å½•: æ¯ç”¨æˆ· 100-1000 æ¡
â””â”€â”€ æ•°æ®åº“å¤§å°: ~10-50MB

ä¸­å‹åº”ç”¨ (1ä¸‡-100ä¸‡ç”¨æˆ·)
â”œâ”€â”€ ç¿»è¯‘å†å²: æ¯ç”¨æˆ· 5000-10000 æ¡
â”œâ”€â”€ æ”¶è—è¯æ±‡: æ¯ç”¨æˆ· 500-2000 æ¡
â”œâ”€â”€ æœç´¢è®°å½•: æ¯ç”¨æˆ· 1000-5000 æ¡
â””â”€â”€ æ•°æ®åº“å¤§å°: ~50-200MB

å¤§å‹åº”ç”¨ (> 100ä¸‡ç”¨æˆ·)
â”œâ”€â”€ å®ç°æ•°æ®å¯¼å‡º/å¯¼å…¥
â”œâ”€â”€ å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
â”œâ”€â”€ è€ƒè™‘äº‘åŒæ­¥
â””â”€â”€ æ•°æ®åº“å¤§å°: > 200MB (éœ€è¦åˆ†ç‰‡)
```

---

## é£é™©è¯„ä¼°å’Œåº”å¯¹

### ğŸš¨ å¯èƒ½çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. go_router ä¸­è®¿é—® Riverpod å¼‚æ­¥çŠ¶æ€

**é—®é¢˜**: `redirect` å›è°ƒä¸­æ— æ³•ç›´æ¥ `await`

**è§£å†³æ–¹æ¡ˆ**:
```dart
// ä½¿ç”¨ refreshListenable æ¨¡å¼
GoRouter(
  refreshListenable: Listenable.merge([
    authNotifier,  // ç›‘å¬è®¤è¯çŠ¶æ€å˜åŒ–
  ]),
  redirect: (context, state) {
    // åŒæ­¥è®¿é—®çŠ¶æ€ï¼Œä¸éœ€è¦ await
  },
)
```

#### 2. Isar å¤§æ•°æ®é‡æŸ¥è¯¢å¡é¡¿

**é—®é¢˜**: æŸ¥è¯¢ 10ä¸‡+ æ¡è®°å½•æ—¶ UI å¡é¡¿

**è§£å†³æ–¹æ¡ˆ**:
```dart
// 1. åˆ†é¡µæŸ¥è¯¢
final page1 = await isar.translationHistories
  .where()
  .offset(0)
  .limit(50)
  .findAll();

// 2. æ·»åŠ ç´¢å¼•åŠ å¿«æŸ¥è¯¢
@collection
class TranslationHistory {
  @Index(type: IndexType.value)
  late String sourceLang;  // æ·»åŠ ç´¢å¼•
}

// 3. å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
await isar.writeTxn(() async {
  final oldRecords = await isar.translationHistories
    .filter()
    .timestampLessThan(thirtyDaysAgo)
    .findAll();
  await isar.translationHistories.deleteAll(oldRecords.map((r) => r.id).toList());
});
```

#### 3. Hive å¹¶å‘ä¿®æ”¹å´©æºƒ

**é—®é¢˜**: å¤šä¸ªå¼‚æ­¥ä»»åŠ¡åŒæ—¶å†™å…¥ Hive

**è§£å†³æ–¹æ¡ˆ**:
```dart
// âœ… æ­£ç¡®ï¼šä½¿ç”¨äº‹åŠ¡æˆ–é¡ºåºæ‰§è¡Œ
await preferencesBox.putAll({
  'lang': 'ug',
  'darkMode': true,
});

// âŒ é¿å…ï¼šå¹¶å‘å†™å…¥
Future.wait([
  preferencesBox.put('lang', 'ug'),
  preferencesBox.put('darkMode', true),
]);
```

#### 4. Web å¹³å°å…¼å®¹æ€§é—®é¢˜

**é—®é¢˜**: æŸäº›åº“ä¸æ”¯æŒ Web

**è§£å†³æ–¹æ¡ˆ**:
```dart
// ä½¿ç”¨æ¡ä»¶å¯¼å…¥
import 'db_io.dart' if (dart.library.html) 'db_web.dart';

// æˆ–æ£€æŸ¥å¹³å°åé€‰æ‹©å®ç°
if (kIsWeb) {
  // ä½¿ç”¨ Sembast
} else {
  // ä½¿ç”¨ Isar
}
```

---

## è¿ç§»å’Œå‡çº§è·¯å¾„

### ä»ç°æœ‰æ–¹æ¡ˆè¿ç§»

#### ä» SharedPreferences è¿ç§»åˆ° Hive

```dart
// 1. è¯»å–æ—§æ•°æ®
final prefs = await SharedPreferences.getInstance();
final oldLang = prefs.getString('language') ?? 'en';

// 2. è¿ç§»åˆ° Hive
final box = await Hive.openBox<UserPreferences>('user_prefs');
final newPrefs = UserPreferences()..sourceLang = oldLang;
await box.put('current', newPrefs);

// 3. æ¸…ç†æ—§æ•°æ®
await prefs.clear();
```

#### ä» sqflite è¿ç§»åˆ° Isar

```dart
// 1. å¯¼å‡º sqflite æ•°æ®
final records = await database.query('translations');

// 2. å¯¼å…¥åˆ° Isar
await isar.writeTxn(() async {
  for (final record in records) {
    await isar.translationHistories.put(
      TranslationHistory()
        ..sourceText = record['source_text']
        ..targetText = record['target_text']
        // ... å…¶ä»–å­—æ®µ
    );
  }
});
```

---

## å‘å¸ƒå‰æ£€æŸ¥æ¸…å•

### âœ… è·¯ç”±æ£€æŸ¥

- [ ] æ‰€æœ‰è·¯ç”±åœ¨ go_router ä¸­å®šä¹‰
- [ ] æ·±åº¦é“¾æ¥åœ¨ Android/iOS manifest ä¸­é…ç½®
- [ ] è·¯ç”±å®ˆå«æ­£ç¡®å®ç°è®¤è¯æ£€æŸ¥
- [ ] é”™è¯¯è·¯ç”±å¤„ç†å·²å®ç°
- [ ] è¿”å›é”®è¡Œä¸ºç¬¦åˆé¢„æœŸ

### âœ… æ•°æ®åº“æ£€æŸ¥

- [ ] Isar è¿ç§»è„šæœ¬å·²ç¼–å†™
- [ ] æ•°æ®å¤‡ä»½/å¯¼å‡ºåŠŸèƒ½å·²å®ç°
- [ ] å¤§æ•°æ®é‡æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] åŠ å¯†å¯†é’¥å®‰å…¨å­˜å‚¨
- [ ] æ•°æ®åº“å¤§å°åœ¨å¯æ¥å—èŒƒå›´

### âœ… çŠ¶æ€ç®¡ç†æ£€æŸ¥

- [ ] Riverpod provider æ— å†…å­˜æ³„æ¼
- [ ] å¼‚æ­¥æ“ä½œæ­£ç¡®å¤„ç†
- [ ] é”™è¯¯çŠ¶æ€æ˜¾ç¤ºç»™ç”¨æˆ·
- [ ] ç¦»çº¿æ¨¡å¼æ”¯æŒ

---

## åç»­ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸ (1-3 ä¸ªæœˆ)

- [ ] æ·»åŠ æ•°æ®åŒæ­¥åŠŸèƒ½ (äº‘å¤‡ä»½)
- [ ] å®ç°é«˜çº§æœç´¢è¿‡æ»¤
- [ ] æ€§èƒ½ç›‘æ§å’Œæ—¥å¿—

### ä¸­æœŸ (3-6 ä¸ªæœˆ)

- [ ] å¤šè®¾å¤‡æ•°æ®åŒæ­¥
- [ ] ç¦»çº¿ä¼˜å…ˆæ¶æ„
- [ ] æ•°æ®åˆ†æå’Œç»Ÿè®¡

### é•¿æœŸ (6+ ä¸ªæœˆ)

- [ ] åˆ†å¸ƒå¼å­˜å‚¨æ”¯æŒ
- [ ] AI è¾…åŠ©ç¿»è¯‘å»ºè®®
- [ ] ç¤¾åŒºè´¡çŒ®çš„ç¿»è¯‘åº“

---

## å­¦ä¹ èµ„æº

### æ–‡æ¡£
- [go_router å®˜æ–¹æ–‡æ¡£](https://pub.dev/packages/go_router)
- [Riverpod å®˜æ–¹æ–‡æ¡£](https://riverpod.dev/)
- [Isar å®˜æ–¹æ–‡æ¡£](https://isar.dev/)
- [Hive å®˜æ–¹æ–‡æ¡£](https://docs.hivedb.dev/)

### ç¤ºä¾‹é¡¹ç›®
- [go_router ç¤ºä¾‹](https://github.com/flutter/packages/tree/main/packages/go_router/example)
- [Isar ç¤ºä¾‹](https://github.com/isar/isar/tree/main/examples)
- [Riverpod ç¤ºä¾‹](https://github.com/rrousselGit/riverpod/tree/master/examples)

### ç¤¾åŒºèµ„æº
- Flutter ä¸­æ–‡ç¤¾åŒº: https://flutter.cn
- GetX ä¸­æ–‡æ–‡æ¡£: https://github.com/jonataslaw/getx/blob/master/README.zh-cn.md
- Riverpod è®¨è®º: https://github.com/rrousselGit/riverpod/discussions

---

## æ€»ç»“

âœ… **æ¨èä½¿ç”¨**: go_router + Riverpod + Isar + Hive
- **æˆç†Ÿåº¦**: â­â­â­â­â­ ç”Ÿäº§çº§
- **ç¤¾åŒº**: â­â­â­â­â­ æ´»è·ƒåº¦é«˜
- **æ€§èƒ½**: â­â­â­â­â­ ä¼˜å¼‚
- **æ–‡æ¡£**: â­â­â­â­â­ è¯¦ç»†å®Œå–„
- **å­¦ä¹ æ›²çº¿**: â­â­â­â˜†â˜† ä¸­ç­‰ï¼ˆ3-5 å¤©ä¸Šæ‰‹ï¼‰

ğŸ’¡ **å…³é”®æˆåŠŸè¦ç´ **:
1. æ­£ç¡®ç†è§£ go_router çš„ redirect æœºåˆ¶
2. åˆç†ä½¿ç”¨ Isar ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢
3. æ­£ç¡®å¤„ç† Riverpod å¼‚æ­¥çŠ¶æ€
4. å®šæœŸè¿›è¡Œæ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–

ğŸš€ **é¢„æœŸæˆæœ**:
- åº”ç”¨å¯åŠ¨æ—¶é—´ < 2s
- æŸ¥è¯¢å“åº”æ—¶é—´ < 100ms
- ç”¨æˆ·ä½“éªŒæµç•…ã€ç¨³å®š

---

**æœ€åæ›´æ–°**: 2025å¹´12æœˆ4æ—¥
**ä½œè€…**: AI Research Team
**ç‰ˆæœ¬**: 1.0

